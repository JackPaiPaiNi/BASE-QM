/**
 *
 * 信息管理部软件开发科Bootstrap插件系列
 * 
 * jquery.sky.main 登录页面和主页面框架
 *
 * 王歌 2016年11月
 */
function sumWidth(a){var b=0;$(a).each(function(){b+=$(this).outerWidth(!0)});return b}
function setActive(a){var b=sumWidth($(a).prevAll()),d=sumWidth($(a).nextAll()),c=sumWidth($(".content-tabs").children().not(".mtabs")),c=$(".content-tabs").outerWidth(!0)-c,e=0;if($(".page-tabs-content").outerWidth()<c)e=0;else if(d<=c-$(a).outerWidth(!0)-$(a).next().outerWidth(!0)){if(c-$(a).next().outerWidth(!0)>d)for(e=b;e-$(a).outerWidth()>$(".page-tabs-content").outerWidth()-c;)e-=$(a).prev().outerWidth(),a=$(a).prev()}else b>c-$(a).outerWidth(!0)-$(a).prev().outerWidth(!0)&&(e=b-$(a).prev().outerWidth(!0));
$(".page-tabs-content").animate({marginLeft:0-e+"px"},"fast")}function generateSlimScroll(a){var b=$(a).attr("data-height"),b=b?b:$(a).height(),b={height:b,alwaysVisible:!0};/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(b.wheelStep=1,b.touchScrollStep=100);$(a).slimScroll(b)}
$(function(){$(".sidebar li[mlevel]").children("a").click(function(a){if(0===$(".page-sidebar-minified").length){var b=$(this).closest("li[mlevel]");b.hasClass("active")?b.hasClass("has-sub")&&$(this).next(".sub-menu").slideToggle(250):(a=b.siblings("li[mlevel].active"),a.children(".sub-menu").slideUp(250),a.removeClass("active"),a.find("li[mlevel].active").children(".sub-menu").slideUp(250),a.find("li[mlevel].active").removeClass("active"),b.hasClass("has-sub")?$(this).next(".sub-menu").slideToggle(250,
function(){b.addClass("active")}):b.addClass("active"))}});$(".sidebar-minify-btn").click(function(a){a.preventDefault();$(".page-container").hasClass("page-sidebar-minified")?($(".page-container").removeClass("page-sidebar-minified"),$(".page-container").hasClass("page-sidebar-fixed")&&generateSlimScroll($('.sidebar [data-scrollbar="true"]'))):($(".page-container").addClass("page-sidebar-minified"),$(".page-container").hasClass("page-sidebar-fixed")&&($('.sidebar [data-scrollbar="true"]').slimScroll({destroy:!0}),
$('.sidebar [data-scrollbar="true"]').removeAttr("style")),$(".sidebar [data-scrollbar=true]").trigger("mouseover"));$(window).trigger("resize")});$(".sidebar").on("click","li a[menuId]",function(){var a=$(this).attr("url"),b=$(this).attr("menuId"),d=$(this).attr("text"),c=!0;if(void 0==a||0==$.trim(a).length)return!1;a=-1<a.indexOf("?")?a+"&":a+"?";a+="cdid="+b;$(".mtab").each(function(){if($(this).attr("menuId")==b)return $(this).hasClass("active")||($(this).addClass("active").siblings(".mtab").removeClass("active"),
setActive(this),$(".mtabContent .mtabIframe").each(function(){if($(this).attr("menuId")==b)return $(this).show().siblings(".mtabIframe").hide(),!1})),c=!1});c&&(d='<a href="javascript:;" class="active mtab" menuId="'+b+'">'+d+' <i class="fa fa-times-circle"></i></a>',$(".mtab").removeClass("active"),a='<iframe class="mtabIframe" width="100%" height="'+getIframeHeight()+'" src="'+a+'" frameborder="0" menuId="'+b+'"></iframe>',$(".mtabContent").find("iframe.mtabIframe").hide().parents(".mtabContent").append(a),
$(".mtabs .page-tabs-content").append(d),setActive($(".mtab.active")));return!1});$(".mtabs").on("click",".mtab i",function(){var a=$(this).parents(".mtab").attr("menuId"),b=$(this).parents(".mtab").width();if($(this).parents(".mtab").hasClass("active")){if($(this).parents(".mtab").next(".mtab").size()){var d=$(this).parents(".mtab").next(".mtab:eq(0)").attr("menuId");$(this).parents(".mtab").next(".mtab:eq(0)").addClass("active");$(".mtabContent .mtabIframe").each(function(){if($(this).attr("menuId")==
d)return $(this).show().siblings(".mtabIframe").hide(),!1});var c=parseInt($(".page-tabs-content").css("margin-left"));0>c&&$(".page-tabs-content").animate({marginLeft:c+b+"px"},"fast");$(this).parents(".mtab").remove();$(".mtabContent .mtabIframe").each(function(){if($(this).attr("menuId")==a)return $(this).remove(),!1})}$(this).parents(".mtab").prev(".mtab").size()&&(d=$(this).parents(".mtab").prev(".mtab:last").attr("menuId"),$(this).parents(".mtab").prev(".mtab:last").addClass("active"),$(".mtabContent .mtabIframe").each(function(){if($(this).attr("menuId")==
d)return $(this).show().siblings(".mtabIframe").hide(),!1}),$(this).parents(".mtab").remove(),$(".mtabContent .mtabIframe").each(function(){if($(this).attr("menuId")==a)return $(this).remove(),!1}))}else $(this).parents(".mtab").remove(),$(".mtabContent .mtabIframe").each(function(){if($(this).attr("menuId")==a)return $(this).remove(),!1});setActive($(".mtab.active"));return!1});$(".mtabs").on("click",".mtab",function(){if(!$(this).hasClass("active")){var a=$(this).attr("menuId");$(".mtabContent .mtabIframe").each(function(){if($(this).attr("menuId")==
a)return $(this).show().siblings(".mtabIframe").hide(),!1});$(this).addClass("active").siblings(".mtab").removeClass("active");setActive(this);for(var b=$(".sidebar a[menuId="+a+"]"),d=b.closest("li[mlevel]").attr("mlevel"),c=1;c<parseInt(d)+1;c++)b.parents("[mlevel="+c+"]").not(".active").children("a").trigger("click")}});$(".mtabLeft").on("click",function(){var a=Math.abs(parseInt($(".page-tabs-content").css("margin-left"))),b=sumWidth($(".content-tabs").children().not(".mtabs")),b=$(".content-tabs").outerWidth(!0)-
b,d=0;if($(".page-tabs-content").width()<b)return!1;for(var c=$(".mtab:first"),e=0;e+$(c).outerWidth(!0)<=a;)e+=$(c).outerWidth(!0),c=$(c).next();e=0;if(sumWidth($(c).prevAll())>b){for(;e+$(c).outerWidth(!0)<b&&0<c.length;)e+=$(c).outerWidth(!0),c=$(c).prev();d=sumWidth($(c).prevAll())}$(".page-tabs-content").animate({marginLeft:0-d+"px"},"fast")});$(".mtabRight").on("click",function(){var a=Math.abs(parseInt($(".page-tabs-content").css("margin-left"))),b=sumWidth($(".content-tabs").children().not(".mtabs")),
b=$(".content-tabs").outerWidth(!0)-b;if($(".page-tabs-content").width()<b)return!1;for(var d=$(".mtab:first"),c=0;c+$(d).outerWidth(!0)<=a;)c+=$(d).outerWidth(!0),d=$(d).next();for(c=0;c+$(d).outerWidth(!0)<b&&0<d.length;)c+=$(d).outerWidth(!0),d=$(d).next();a=sumWidth($(d).prevAll());0<a&&$(".page-tabs-content").animate({marginLeft:0-a+"px"},"fast")});$(".mtabCloseAll").on("click",function(){$(".page-tabs-content").children("[menuId]").not(":first").each(function(){$('.mtabIframe[menuId="'+$(this).attr("menuId")+
'"]').remove();$(this).remove()});$(".page-tabs-content").children("[menuId]:first").each(function(){$('.mtabIframe[menuId="'+$(this).attr("menuId")+'"]').show();$(this).addClass("active")});$(".page-tabs-content").css("margin-left","0")});$(".mtabCloseOther").on("click",function(){$(".page-tabs-content").children("[menuId]").not(":first").not(".active").each(function(){$('.mtabIframe[menuId="'+$(this).attr("menuId")+'"]').remove();$(this).remove()});$(".page-tabs-content").css("margin-left","0")});
$("[data-scrollbar=true]").each(function(){generateSlimScroll($(this))});$(document).scroll(function(){200<=$(document).scrollTop()?$("[data-click=scroll-top]").addClass("in"):$("[data-click=scroll-top]").removeClass("in")});$("[data-click=scroll-top]").click(function(a){a.preventDefault();$("html, body").animate({scrollTop:$("body").offset().top},500)})});