/**
 *
 * 信息管理部软件开发科Bootstrap插件系列
 * 
 * jquery.sky.gridSelect 本地数据选择框-基于gridSelect
 *
 * 王歌 2016年11月
 */
(function(b){function h(a,d){b(a).attr("gridTargetID",d.gridTargetID.replace("#",""));b(a).wrap('<span style="cursor:pointer;" class="input-icon input-icon-right"></span>');var c=b(a).parent("span");c.append('<i class="fa '+(d.multiple?"fa-search-plus":"fa-search")+' openBtn primary"></i>');c.find(".openBtn").bind("click.gridSelect",function(){g(a)});var e=b(d.gridTargetID).data("skySelect").data("options");e.autoComplete&&!e.multiple&&b(a).skyAutoComplete({data:e.data,displayText:e.displayText,text:e.textColumn,
appendTo:b(a).closest("td"),afterSelect:function(c){b(d.gridTargetID).data("gridSelect",a);b(d.gridTargetID).skySelect("setValue",c[e.valueColumn]);d.confirm&&d.confirm(c,c[e.valueColumn],c[e.textColumn])}});c.data("options",d);return c}function g(a){var d=b(a).data("gridSelect").data("options"),c=b(a).data("value");b(d.gridTargetID).skySelect("setValue",c);b(d.gridTargetID).data("gridSelect",a);b(d.gridTargetID).skySelect("open")}function f(a,d){var c=b(a).data("gridSelect"),e=c.data("options"),
c=b(a).parent();e.disabled=d;b(a).addClass("skydisabled").prop("disabled","disabled");c.find(".openBtn").removeClass("primary").unbind("click.gridSelect");d||(b(a).removeClass("skydisabled").removeProp("disabled").removeAttr("disabled"),c.find(".openBtn").addClass("primary").bind("click.gridSelect",function(){g(a)}))}b.fn.gridSelect=function(a,d){return"string"==typeof a?b.fn.gridSelect.methods[a](this,d):this.each(function(){var c=b(this).data("gridSelect");c||(c=h(this,a),b(this).data("gridSelect",
c));f(this,a.disabled)})};b.fn.gridSelect.methods={disable:function(a){return a.each(function(){f(this,!0)})},enable:function(a){return a.each(function(){f(this,!1)})}};b.fn.gridSelect.defaults={gridTargetID:null,confirm:function(a,b,c){},cancel:function(){}}})(jQuery);